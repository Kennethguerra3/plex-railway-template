[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "/init"
healthcheckPath = "/identity"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Configuración de red - Exponer el puerto principal de Plex
[[deploy.serviceMesh]]
name = "plex-web"
port = 32400
protocol = "TCP"

# Volúmenes persistentes críticos
[[deploy.volumes]]
mountPath = "/config"
name = "plex-config"

[[deploy.volumes]]
mountPath = "/data"
name = "plex-data"

[[deploy.volumes]]
mountPath = "/transcode"
name = "plex-transcode"
